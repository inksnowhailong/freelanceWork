<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>河大文创</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  </head>
  <body>
    <header>
      <button class="menu">&#9776;</button>
      <h1>！</h1>
      <nav>
        <ul>
          <li><a href="#">河大文创</a></li>

          <li><a href="index2.html">学校简介</a></li>
          <li><a href="index1.html">购物车</a></li>
          <li><a href="index7.html">历史订单</a></li>
          <li><a href="index4.html">个人信息</a></li>
        </ul>
      </nav>
    </header>
    <main>
      <section class="news">
        <h2>河大毕业季&文创产品特卖中！</h2>
        <p>创意点亮校园，河大文创产品持续上新</p>
        <p><a href="index5.html">●了解更多●</a></p>
      </section>

      <section class="slogan">
        <blockquote>
          谢谢与河大的相遇，也感谢河大让我遇见了很多喜欢的人。

          <p>一同钻研学业的同窗同学，</p>
          <p>志趣相投的社团朋友 ，</p>
          <p>帮助前行的各位可爱的老师 ······</p>
          <p>舍不得的大学故事，忘不掉的情谊</p>
          那就带走吧~
        </blockquote>
      </section>

      <section class="shop">
        <img src="images/p7.webp" alt="实事求是" />
        <div class="info">
          <h2>“河你相遇”把最好的纪念品留给你</h2>
          <br />
          风里雨里，河你一起！<br />
          <p>
            你怕六月的毕业季伤感太多 我怕这葱郁的校园舍不得你们 把河大文创带回家
            把河大的回忆记在心上 祝愿每一位河大青年们 归来仍是少年
          </p>
        </div>
      </section>
      <section class="zixun">
        <h2><br />全部商品</h2>
      </section>

      <section class="product" id="productList"></section>

      <section class="newsletter">
        <p>欢迎订阅河大文创官网，快来领取福利哟</p>
        <form>
          <input type="email" placeholder="请输入您的 Email" required />
          <button type="submit">送出</button>
        </form>
      </section>
    </main>
    <footer>
      <p>Copyright © 2023 信管三班 All Rights Reserved.</p>
    </footer>
  </body>
  <script>

    $.ajax({
      url: "http://localhost:8084/product/list?pageNum=1&pageSize=10",
      type: "get",
      success: function (res) {
        console.log(res);
        // 向列表中加入商品
        const productList = document.getElementById("productList");
        res.data.list.forEach((item) => {
          const div = document.createElement("div");
          div.innerHTML = `
            <img src="${item.image}" alt="${item.name}">
            <h3>${item.name}</h3>
            <p>${item.detail}</p>
            <p>价格：${item.price}</p>
            <p>库存：${item.stock}</p>
            <p class="addCar">加入购物车</p>
        `;
          div.getElementsByClassName("addCar")[0].onclick = function () {
            addCarMethod(item.id);
          };
          productList.appendChild(div);
        });
      },
    });

    function addCarMethod(id) {
      if (!sessionStorage.getItem('userinfo')) {
        window.location.href = 'index4.html';
    }
      $.ajax({
        url: "http://localhost:8084/cart/add",
        type: "post",
        data: {
          productId: id,
          userId: JSON.parse(sessionStorage.getItem("userinfo")).id,
          count:1
        },
        success: function (res) {
          window.location.href = "index1.html";
        },
      });
    }
  </script>
</html>
